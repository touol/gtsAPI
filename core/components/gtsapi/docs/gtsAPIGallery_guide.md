# Руководство по использованию gtsAPIGallery

## Описание

Сниппет `gtsAPIGallery` предназначен для отображения галереи файлов из таблицы `gtsAPIFile`. Это аналог сниппета `msGallery` из miniShop2, адаптированный для работы с файловой системой gtsAPI.

## Основные возможности

- Отображение файлов в виде галереи
- Поддержка изображений с превью разных размеров
- Отображение иконок для различных типов файлов
- Модальное окно для просмотра изображений
- Фильтрация по типу файлов
- Группировка файлов по спискам
- Адаптивный дизайн

## Базовое использование

```
[[gtsAPIGallery]]
```

Выведет все активные файлы, привязанные к текущему ресурсу.

## Параметры

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `parent` | число | ID текущего ресурса | ID родительского объекта |
| `parentClass` | строка | `modResource` | Класс родительского объекта |
| `list` | строка | `` | Список файлов (дополнительная группировка) |
| `filetype` | строка | `` | Фильтр по типу файла (через запятую) |
| `limit` | число | `0` | Лимит количества файлов (0 - без ограничений) |
| `tpl` | строка | `tpl.gtsAPIGallery` | Шаблон для вывода галереи |
| `showInactive` | логический | `false` | Показывать неактивные файлы |
| `showLog` | логический | `false` | Показывать лог выполнения (только для менеджеров) |
| `toPlaceholder` | строка | `` | Сохранить результат в плейсхолдер вместо вывода |

## Примеры использования

### Галерея изображений

```
[[gtsAPIGallery? 
    &filetype=`image,jpg,jpeg,png,gif,webp`
    &limit=`12`
]]
```

### Файлы определенного списка

```
[[gtsAPIGallery? 
    &list=`documents`
    &parent=`5`
]]
```

### Только PDF файлы

```
[[gtsAPIGallery? 
    &filetype=`pdf`
    &tpl=`tpl.gtsAPIGallery.Documents`
]]
```

### Сохранение в плейсхолдер

```
[[gtsAPIGallery? 
    &toPlaceholder=`gallery`
    &limit=`6`
]]

<div class="my-gallery">
    [[+gallery]]
</div>
```

## Структура данных файла

Каждый файл в галерее содержит следующие поля:

- `id` - ID файла
- `name` - Название файла
- `description` - Описание файла
- `url` - URL файла
- `type` - Тип файла
- `size` - Размер файла в байтах
- `size_formatted` - Отформатированный размер файла
- `createdon` - Дата создания
- `createdon_formatted` - Отформатированная дата создания
- `thumbnail` - URL иконки для файла
- `small`, `medium`, `large` - URL превью разных размеров (для изображений)

## Настройка превью

Размеры превью настраиваются через системную настройку:

```
gtsapi.thumbnail_sizes = small,medium,large
```

## Кастомизация шаблона

Для создания собственного шаблона галереи создайте чанк и укажите его в параметре `tpl`:

```html
<div class="my-gallery">
    {if $files}
        {foreach $files as $file}
            <div class="gallery-item">
                <img src="{$file.small ?: $file.url}" alt="{$file.name}">
                <h3>{$file.name}</h3>
                <p>{$file.description}</p>
                <span>{$file.size_formatted}</span>
            </div>
        {/foreach}
    {else}
        <p>Файлы не найдены</p>
    {/if}
</div>
```

## Возвращаемые форматы

### Данные (return=data)

```
[[gtsAPIGallery? &return=`data`]]
```

Возвращает массив файлов для дальнейшей обработки.

### JSON (return=json)

```
[[gtsAPIGallery? &return=`json`]]
```

Возвращает файлы в формате JSON.

### SQL (return=sql)

```
[[gtsAPIGallery? &return=`sql`]]
```

Возвращает SQL-запрос для отладки.

## Требования

- MODX Revolution 2.3+
- pdoTools
- gtsAPI компонент
- Таблица `gtsapi_files` должна быть создана

## Поддержка файлов

### Изображения
- Автоматическое создание превью
- Модальное окно для просмотра
- Поддерживаемые форматы: JPG, JPEG, PNG, GIF, WebP

### Документы
- Отображение иконок по типу файла
- Прямые ссылки для скачивания
- Поддержка всех типов файлов

## Стилизация

Галерея использует CSS-классы с префиксом `gtsapi-gallery-` для удобной кастомизации:

- `.gtsapi-gallery` - основной контейнер
- `.gtsapi-gallery-items` - сетка элементов
- `.gtsapi-gallery-item` - отдельный элемент
- `.gtsapi-gallery-preview` - область превью
- `.gtsapi-gallery-info` - информация о файле

## Отладка

Для отладки используйте параметр `showLog=1` (доступно только администраторам):

```
[[gtsAPIGallery? &showLog=`1`]]
```

Это покажет время выполнения запросов и другую отладочную информацию.
